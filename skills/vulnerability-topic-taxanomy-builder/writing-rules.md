# Writing Rules — Source Dissolution Examples

This document provides concrete before/after examples of how to dissolve source-specific findings into generalized taxonomy entries.

---

## Rule 1: Source Dissolution

### ❌ BAD — Source structures the content

```markdown
### WAFFLED Research (ACSAC 2025)

WAFFLED discovered 1,207 WAF bypasses across 3 content types:
- JSON: 557 bypasses
- Multipart: 351 bypasses  
- XML: 299 bypasses
```

### ✅ GOOD — Technique structures the content, source is invisible

```markdown
### §5-1. Content-Type Switching & Confusion

| Technique | Example | Mismatch Effect |
|-----------|---------|----------------|
| **CT substitution** | Send `multipart/form-data` to a urlencoded endpoint | WAF applies wrong parsing rules. Empirically 90%+ of websites accept both CTs interchangeably |
| **CT omission** | Remove Content-Type header entirely | Framework's default parser diverges from WAF's assumed parser |
| ...

### §5-3. JSON Structure Mutations

| Technique | Description |
|-----------|-------------|
| **Duplicate keys** | `{"key":"safe","key":"<xss>"}` — which value is adopted depends on parser (RFC 8259 leaves this undefined) |
| **Unicode escapes** | `\u003cscript\u003e` — WAF sees string literal, app decodes to HTML |
| ...
```

**What changed**: The 1,207 bypasses became individual technique entries under §5, organized by structural target (CT switching, multipart, JSON, XML). The paper's contribution is *implicit* — its findings enrich every relevant category.

---

## Rule 2: Mechanism Over Attribution

### ❌ BAD — Named after researcher

```markdown
#### Kettle 2025's 0.CL Desync

James Kettle discovered that 0.CL creates a deadlock that can be broken 
via early response gadgets. This earned $350K+ in bounties.
```

### ✅ GOOD — Named after mechanism

```markdown
#### 0.CL (Zero-to-Content-Length)

Front-End treats the request as having no body (implicit zero) and forwards 
immediately. Back-End reads Content-Length bytes, creating a **deadlock**. 
The deadlock is exploitable when an **Early Response Gadget** causes the 
Back-End to respond before consuming the full body:
- Static file requests
- Windows reserved filenames (CON, PRN, AUX, NUL)
- Server-level redirects
- `Expect: 100-continue` header

Commonly combined with CL header whitespace obfuscation 
(`Content-Length : 76`) to prevent Front-End from recognizing the header.

CVE-2025-32094 (Akamai): $9,000 bounty, 65-day patch cycle, 
tens of millions of sites affected.
```

**What changed**: The researcher name disappeared. The mechanism is self-explanatory. The CVE and bounty appear as factual evidence, not as attribution.

---

## Rule 3: Category Naming

### ❌ BAD — Named after paper's internal terminology

```markdown
### Category I: HTTP Garden Low-Level Parser Mutations

HTTP Garden (USENIX Security 2024) discovered 100+ parsing bugs...
```

### ✅ GOOD — Named after structural target

```markdown
### §7. Low-Level Parser Implementation Divergence

Individual servers and proxies implement HTTP parsing with varying 
degrees of leniency relative to the RFC. These micro-differences 
underlie all mutations in §1–§6 and are systematically discoverable 
via differential fuzzing.

| Technique | Description |
|-----------|-------------|
| **Bare LF** | `\n` without `\r` — some servers accept, others reject |
| ...
```

---

## Rule 4: Cross-Reference Pattern

### ❌ BAD — Repeating content

```markdown
### §1-2. Zero-Length Desync

0.CL works by... [full explanation]

### §2-2. Content-Length Obfuscation  

In 0.CL attacks, CL whitespace obfuscation is used to... [repeats 0.CL explanation]
```

### ✅ GOOD — Cross-reference with §-notation

```markdown
### §2-2. Content-Length Header Obfuscation

| Technique | Example | Parser Difference |
|-----------|---------|------------------|
| **Colon whitespace** | `Content-Length : 42` | Core enabler for 0.CL attacks (§1-2): Front-End fails to recognize CL header |
| ...
```

---

## Rule 5: CVE/Bounty Table Linking

### ❌ BAD — Vague descriptions

```markdown
| CVE-2025-32094 | Akamai | HTTP smuggling vulnerability |
```

### ✅ GOOD — Linked to specific § mutation combinations

```markdown
| §1-2 (0.CL) + §2-1 (TE line folding) + §2-2 (CL whitespace) | CVE-2025-32094 (Akamai) | $9,000. Full infrastructure impact, 65-day patch cycle |
```

---

## Rule 6: Tool Matrix Style

### ❌ BAD — Marketing descriptions

```markdown
| HTTP Garden | An amazing differential fuzzing tool created by Narf Industries |
```

### ✅ GOOD — Functional description

```markdown
| **HTTP Garden** (open source) | Origin server parsers | Coverage-guided differential fuzzing with REPL; mutates all request stream components |
```

---

## Rule 7: Summary Section

### ❌ BAD — Lists papers

```markdown
## Summary

Based on Kettle 2025, HTTP Garden 2024, and WAFFLED 2025, we can conclude...
```

### ✅ GOOD — States principles

```markdown
## Summary: Core Principles

All HTTP mutations ultimately stem from **one fact**: HTTP/1.1 is text-based, 
offers multiple ways to specify message boundaries, and thousands of 
independent implementations interpret the spec with varying degrees of 
leniency. HTTP/2 downgrading adds a fourth length interpretation, and 
per-framework Content-Type parsers create a fifth mismatch axis.

Six years of individual patches and regex-based defenses block only 
**known mutation fingerprints** without resolving fundamental parser 
divergence. Structural solutions require upstream HTTP/2 adoption 
(eliminating framing mismatch) combined with RFC-strict normalization 
proxies (eliminating structure/body mismatch).
```
